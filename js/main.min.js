var x,i,j,l,ll,selElmnt,a,b,c;for(l=(x=document.getElementsByClassName("toDo__header-filter-custom")).length,i=0;i<l;i++){for(ll=(selElmnt=x[i].getElementsByTagName("select")[0]).length,(a=document.createElement("DIV")).setAttribute("class","select-selected"),a.innerHTML=selElmnt.options[selElmnt.selectedIndex].innerHTML,x[i].appendChild(a),(b=document.createElement("DIV")).setAttribute("class","select-items select-hide"),j=0;j<ll;j++)(c=document.createElement("DIV")).innerHTML=selElmnt.options[j].innerHTML,c.addEventListener("click",(function(e){var t,o,d,n,l,a,i;for(a=(n=this.parentNode.parentNode.getElementsByTagName("select")[0]).length,l=this.parentNode.previousSibling,o=0;o<a;o++)if(n.options[o].innerHTML==this.innerHTML){for(n.selectedIndex=o,l.innerHTML=this.innerHTML,i=(t=this.parentNode.getElementsByClassName("same-as-selected")).length,d=0;d<i;d++)t[d].removeAttribute("class");this.setAttribute("class","same-as-selected");break}l.click()})),b.appendChild(c);x[i].appendChild(b),a.addEventListener("click",(function(e){e.stopPropagation(),closeAllSelect(this),this.nextSibling.classList.toggle("select-hide"),this.classList.toggle("select-arrow-active")}))}function closeAllSelect(e){var t,o,d,n,l,a=[];for(t=document.getElementsByClassName("select-items"),o=document.getElementsByClassName("select-selected"),n=t.length,l=o.length,d=0;d<l;d++)e==o[d]&&a.push(d);for(d=0;d<n;d++)a.indexOf(d)&&t[d].classList.add("select-hide")}document.addEventListener("click",closeAllSelect);var modalWindow=document.querySelector(".reference-modal-window"),showModalWindowBtn=document.querySelector(".toDo__header-reference-cmd"),closeModalWindow=document.querySelector(".reference-modal-window-close-btn");function toggleModalWindow(){modalWindow.classList.toggle("reference-modal-window-show")}function showHideDescription(e){let t=e.target.closest(".description-link-box").nextElementSibling;0==t.classList.contains("show-hide-description")?t.classList.add("show-hide-description"):t.classList.remove("show-hide-description")}showModalWindowBtn.addEventListener("click",toggleModalWindow),closeModalWindow.addEventListener("click",toggleModalWindow),document.querySelectorAll(".description-link").forEach((function(e){e.addEventListener("click",showHideDescription)}));const fromStorage=localStorage.getItem("toDo"),elemText=document.querySelector(".toDo__add-item-element");function filter(){const e=document.querySelector(".toDo__header-filter").value;document.querySelector(".toDo__added-box").dataset.todoOption=e}function windowOnClick(e){e.target!==document.querySelector(".toDo__add-item-element")&&addItem()}function addItem(e){!elemText.disabled&&elemText.value.length&&(document.querySelector(".toDo__added-box").insertAdjacentHTML("beforeend",create(elemText.value)),elemText.value="",localStorage.setItem("toDo",document.querySelector(".toDo__added-box").innerHTML))}function create(e){return`<li class="toDo__added-item" data-todo-state ="active">\n           <div class="toDo__added-item-ok" >\n            <button class="toDo__added-item-ok-cmd todo__action" type="submit"  data-todo-action="completed" id="toDo-added-item-ok" aria-label="ok">\n             <div class="toDo__added-item-ok-box">\n              <img class="toDo__added-item-ok-img" src="images/maked_task.png" alt=""> \n             </div>                  \n            </button>\n           </div> \n \n          <div class="toDo__added-element">\n            <div class="toDo__added-element-text highlighted  highlighted-width bg-none" contenteditable="false">${e}</div> \n          </div>\n             \n            <div class="toDo__added-item-edit">\n            <button class="toDo__added-item-edit-cmd todo__action" type="submit"  id="toDo-added-item-edit" aria-label="edit">\n             <div class="toDo__added-item-edit-box">\n                <img class="toDo__added-item-edit-img" src="images/edit_task.svg" alt=""> \n              </div>                  \n            </button>\n           </div>\n           <div class="toDo__added-item-delete">\n            <button class="toDo__added-item-delete-cmd todo__action" type="submit"  id="toDo-added-item-delete" aria-label="delete">\n              <div class="toDo__added-item-delete-box">\n                <img class="toDo__added-item-delete-img" src="images/delete_task.png" alt=""> \n              </div>                  \n            </button>\n           </div>  \n          </li>`}document.querySelector(".toDo__added-box").dataset.todoOption="all",fromStorage&&(document.querySelector(".toDo__added-box").innerHTML=fromStorage),document.querySelector(".select-selected").addEventListener("click",filter),document.querySelector(".toDo__header-select-all-cmd").addEventListener("click",(e=>{document.querySelectorAll('.toDo__added-item[data-todo-state="active"]').forEach((e=>{e.dataset.todoState="completed",e.querySelector(".toDo__added-element").querySelector(".toDo__added-element-text").classList.remove("bg-none")}))})),document.querySelector(".toDo__header-remove-all-cmd").addEventListener("click",(e=>{document.querySelectorAll('.toDo__added-item[data-todo-state="completed"]').forEach((e=>{e.dataset.todoState="active",e.querySelector(".toDo__added-element").querySelector(".toDo__added-element-text").classList.add("bg-none")}))})),document.querySelector(".toDo__header-save-cmd").addEventListener("click",(e=>{var t=document.createElement("a");t.download="tasks.txt";let o="1. Активные задачи",d=document.querySelectorAll('.toDo__added-item[data-todo-state="active"]');d.forEach(((e,t)=>{o+="\n1."+(t+1)+". "+e.querySelector(".toDo__added-element").firstElementChild.textContent})),o+="\n\n2. Завершённые задачи",d=document.querySelectorAll('.toDo__added-item[data-todo-state="completed"]'),d.forEach(((e,t)=>{o+="\n2."+(t+1)+". "+e.querySelector(".toDo__added-element").firstElementChild.textContent})),t.href=window.URL.createObjectURL(new Blob([o],{type:"text/plain"})),t.click()})),window.addEventListener("click",windowOnClick),document.querySelector(".toDo__add-item-element").addEventListener("keyup",(e=>{13!=e.which&&13!=e.keyCode||addItem()})),document.getElementById("toDo-add-item-btn").addEventListener("click",addItem);const toDoListAddedItems=document.getElementById("toDo-list-added-items");function handleTodoClickEvent(e){let t=e.target.closest(".toDo__added-item-delete-cmd"),o=e.target.closest(".toDo__added-item-ok-cmd"),d=e.target.closest(".toDo__added-item-edit-cmd");if(toDoListAddedItems.contains(t)||t)t.closest(".toDo__added-item").remove(),localStorage.setItem("toDo",document.querySelector(".toDo__added-box").innerHTML);else if(toDoListAddedItems.contains(o)||o)"completed"==o.closest(".toDo__added-item").dataset.todoState?(o.closest(".toDo__added-item").dataset.todoState="active",o.closest(".toDo__added-item").querySelector(".toDo__added-element").querySelector(".toDo__added-element-text").classList.add("bg-none")):(o.closest(".toDo__added-item").dataset.todoState="completed",o.closest(".toDo__added-item").querySelector(".toDo__added-element").querySelector(".toDo__added-element-text").classList.remove("bg-none"));else if(toDoListAddedItems.contains(d)||d){let e=d.closest(".toDo__added-item").querySelector(".toDo__added-element").querySelector(".toDo__added-element-text");e.addEventListener("focusout",(function(){e.contentEditable="false",e.parentNode.classList.remove("editable")})),e.contentEditable="true",e.parentNode.classList.add("editable");var n=e.innerText;e.innerText=n,e.focus(),function(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var o=document.createRange();o.selectNodeContents(t),o.collapse(!1);var d=window.getSelection();d.removeAllRanges(),d.addRange(o)}else if(void 0!==document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.collapse(!1),n.select()}e.addEventListener("keydown",(t=>{13!=t.keyCode||t.shiftKey||(e.contentEditable="false",e.parentNode.classList.remove("editable"))}))}(e)}localStorage.setItem("toDo",document.querySelector(".toDo__added-box").innerHTML)}toDoListAddedItems.addEventListener("click",handleTodoClickEvent);